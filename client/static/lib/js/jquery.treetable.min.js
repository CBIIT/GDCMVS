!function(a){var i,s,e;i=function(){function t(t,e,n){var r;this.row=t,this.tree=e,this.settings=n,this.id=this.row.data(this.settings.nodeIdAttr),null!=(r=this.row.data(this.settings.parentIdAttr))&&""!==r&&(this.parentId=r),this.treeCell=a(this.row.children(this.settings.columnElType)[this.settings.column]),this.expander=a(this.settings.expanderTemplate),this.indenter=a(this.settings.indenterTemplate),this.children=[],this.initialized=!1,this.treeCell.prepend(this.indenter)}return t.prototype.addChild=function(t){return this.children.push(t)},t.prototype.ancestors=function(){var t,e;for(e=this,t=[];e=e.parentNode();)t.push(e);return t},t.prototype.collapse=function(){return this.collapsed()||(this.row.removeClass("expanded").addClass("collapsed"),this._hideChildren(),this.expander.attr("title",this.settings.stringExpand),this.expander.attr("aria-label",this.settings.stringExpand),this.initialized&&null!=this.settings.onNodeCollapse&&this.settings.onNodeCollapse.apply(this)),this},t.prototype.collapsed=function(){return this.row.hasClass("collapsed")},t.prototype.expand=function(){return this.expanded()||(this.row.removeClass("collapsed").addClass("expanded"),this.initialized&&null!=this.settings.onNodeExpand&&this.settings.onNodeExpand.apply(this),a(this.row).is(":visible")&&this._showChildren(),this.expander.attr("title",this.settings.stringCollapse),this.expander.attr("aria-label",this.settings.stringCollapse)),this},t.prototype.expanded=function(){return this.row.hasClass("expanded")},t.prototype.hide=function(){return this._hideChildren(),this.row.hide(),this},t.prototype.isBranchNode=function(){return 0<this.children.length||!0===this.row.data(this.settings.branchAttr)},t.prototype.updateBranchLeafClass=function(){this.row.removeClass("branch"),this.row.removeClass("leaf"),this.row.addClass(this.isBranchNode()?"branch":"leaf")},t.prototype.level=function(){return this.ancestors().length},t.prototype.parentNode=function(){return null!=this.parentId?this.tree[this.parentId]:null},t.prototype.removeChild=function(t){var e=a.inArray(t,this.children);return this.children.splice(e,1)},t.prototype.render=function(){var e,t,n=this.settings;return!0===n.expandable&&this.isBranchNode()&&(e=function(t){return a(this).parents("table").treetable("node",a(this).parents("tr").data(n.nodeIdAttr)).toggle(),t.preventDefault()},this.indenter.html(this.expander),(t=!0===n.clickableNodeNames?this.treeCell:this.expander).off("click.treetable").on("click.treetable",e),t.off("keydown.treetable").on("keydown.treetable",function(t){13==t.keyCode&&e.apply(this,[t])})),this.indenter[0].style.paddingLeft=this.level()*n.indent+"px",this},t.prototype.reveal=function(){return null!=this.parentId&&this.parentNode().reveal(),this.expand()},t.prototype.setParent=function(t){return null!=this.parentId&&this.tree[this.parentId].removeChild(this),this.parentId=t.id,this.row.data(this.settings.parentIdAttr,t.id),t.addChild(this)},t.prototype.show=function(){return this.initialized||this._initialize(),this.row.show(),this.expanded()&&this._showChildren(),this},t.prototype.toggle=function(){return this.expanded()?this.collapse():this.expand(),this},t.prototype._hideChildren=function(){var t,e,n,r,i;for(i=[],e=0,n=(r=this.children).length;e<n;e++)t=r[e],i.push(t.hide());return i},t.prototype._initialize=function(){var t=this.settings;return this.render(),!0===t.expandable&&"collapsed"===t.initialState?this.collapse():this.expand(),null!=t.onNodeInitialized&&t.onNodeInitialized.apply(this),this.initialized=!0},t.prototype._showChildren=function(){var t,e,n,r,i;for(i=[],e=0,n=(r=this.children).length;e<n;e++)t=r[e],i.push(t.show());return i},t}(),s=function(){function t(t,e){this.table=t,this.settings=e,this.tree={},this.nodes=[],this.roots=[]}return t.prototype.collapseAll=function(){var t,e,n,r,i;for(i=[],e=0,n=(r=this.nodes).length;e<n;e++)t=r[e],i.push(t.collapse());return i},t.prototype.expandAll=function(){var t,e,n,r,i;for(i=[],e=0,n=(r=this.nodes).length;e<n;e++)t=r[e],i.push(t.expand());return i},t.prototype.findLastNode=function(t){return 0<t.children.length?this.findLastNode(t.children[t.children.length-1]):t},t.prototype.loadRows=function(t){var e,n,r;if(null!=t)for(r=0;r<t.length;r++)null!=(n=a(t[r])).data(this.settings.nodeIdAttr)&&(e=new i(n,this.tree,this.settings),this.nodes.push(e),null!=(this.tree[e.id]=e).parentId&&this.tree[e.parentId]?this.tree[e.parentId].addChild(e):this.roots.push(e));for(r=0;r<this.nodes.length;r++)e=this.nodes[r].updateBranchLeafClass();return this},t.prototype.move=function(t,e){var n=t.parentNode();return t!==e&&e.id!==t.parentId&&-1===a.inArray(t,e.ancestors())&&(t.setParent(e),this._moveRows(t,e),1===t.parentNode().children.length&&t.parentNode().render()),n&&n.updateBranchLeafClass(),t.parentNode()&&t.parentNode().updateBranchLeafClass(),t.updateBranchLeafClass(),this},t.prototype.removeNode=function(t){return this.unloadBranch(t),t.row.remove(),null!=t.parentId&&t.parentNode().removeChild(t),delete this.tree[t.id],this.nodes.splice(a.inArray(t,this.nodes),1),this},t.prototype.render=function(){var t,e,n;for(t=0,e=(n=this.roots).length;t<e;t++)n[t].show();return this},t.prototype.sortBranch=function(t,e){return t.children.sort(e),this._sortChildRows(t),this},t.prototype.unloadBranch=function(t){var e,n=t.children.slice(0);for(e=0;e<n.length;e++)this.removeNode(n[e]);return t.children=[],t.updateBranchLeafClass(),this},t.prototype._moveRows=function(t,e){var n,r=t.children;for(t.row.insertAfter(e.row),t.render(),n=r.length-1;0<=n;n--)this._moveRows(r[n],t)},t.prototype._sortChildRows=function(t){return this._moveRows(t,t)},t}(),e={init:function(t,n){var r;return r=a.extend({branchAttr:"ttBranch",clickableNodeNames:!1,column:0,columnElType:"td",expandable:!1,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},t),this.each(function(){var t,e=a(this);return(n||void 0===e.data("treetable"))&&((t=new s(this,r)).loadRows(this.rows).render(),e.addClass("treetable").data("treetable",t),null!=r.onInitialized&&r.onInitialized.apply(t)),e})},destroy:function(){return this.each(function(){return a(this).removeData("treetable").removeClass("treetable")})},collapseAll:function(){return this.data("treetable").collapseAll(),this},collapseNode:function(t){var e=this.data("treetable").tree[t];if(!e)throw new Error("Unknown node '"+t+"'");return e.collapse(),this},expandAll:function(){return this.data("treetable").expandAll(),this},expandNode:function(t){var e=this.data("treetable").tree[t];if(!e)throw new Error("Unknown node '"+t+"'");return e.initialized||e._initialize(),e.expand(),this},loadBranch:function(t,e){var n=this.data("treetable").settings,r=this.data("treetable").tree;if(e=a(e),null==t)this.append(e);else{var i=this.data("treetable").findLastNode(t);e.insertAfter(i.row)}return this.data("treetable").loadRows(e),e.filter("tr").each(function(){r[a(this).data(n.nodeIdAttr)].show()}),null!=t&&t.render().expand(),this},move:function(t,e){var n,r;return r=this.data("treetable").tree[t],n=this.data("treetable").tree[e],this.data("treetable").move(r,n),this},node:function(t){return this.data("treetable").tree[t]},removeNode:function(t){var e=this.data("treetable").tree[t];if(!e)throw new Error("Unknown node '"+t+"'");return this.data("treetable").removeNode(e),this},reveal:function(t){var e=this.data("treetable").tree[t];if(!e)throw new Error("Unknown node '"+t+"'");return e.reveal(),this},sortBranch:function(t,s){var e,n=this.data("treetable").settings;return e=s=s||n.column,a.isNumeric(s)&&(e=function(t,e){var n,r,i;return(r=(n=function(t){var e=t.row.find("td:eq("+s+")").text();return a.trim(e).toUpperCase()})(t))<(i=n(e))?-1:i<r?1:0}),this.data("treetable").sortBranch(t,e),this},unloadBranch:function(t){return this.data("treetable").unloadBranch(t),this}},a.fn.treetable=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?a.error("Method "+t+" does not exist on jQuery.treetable"):e.init.apply(this,arguments)},this.TreeTable||(this.TreeTable={}),this.TreeTable.Node=i,this.TreeTable.Tree=s}(jQuery);